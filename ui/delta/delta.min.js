function DeltaUIExt(){var a=this;this._skinName="delta";this.menu=null;this.ShowMenu=function(){a.Pause();a.isCourseMenuItemsVisible(true);a.UpdateMenuCollapsedStates(a.currentPage());a.menu.open()};this._OnMenuOpened=function(){$("#search").focus();a.EnableKeyboards([a._courseMenuKeyboard])};this.CloseMenu=function(){a.menu.close()};this._OnMenuClosed=function(){a.ClearSelectedCourseItem();a.ClearCourseItemFilter();$("#search").blur();a.EnableKeyboards([a._defaultKeyboard,a._frameKeyboard]);a.Play()};this.UpdateMenuCollapsedStates=function(d){if(!d){return false}ko.utils.arrayForEach(a.currentOrg().topicsList(),function(e){e.isItemsVisible(false)});function c(e){if(e){var g=a.currentOrg().itemsDict()[e];if(g){g.isItemsVisible(true);var f=g.parentId;if(f){c(f)}}}}c(d.parentId);var b=$("#menu .cmenu-item.isCurrent");if(b.length){b.get(0).scrollIntoView(true)}};this.HandleMenuItemClick=function(c,b){if(c.type==="topic"){a.SelectCourseItem(c);a.CollapseItemGroup(c,b)}else{a.LoadPageFromNav(c,b)}};this.CollapseItemGroup=function(c,b){c.isItemsVisible(!c.isItemsVisible())};this.GetInlineMenuItemStyle=function(d){var b=0;function c(e){if(e&&e.parentId){b+=1;var f=a.currentOrg().itemsDict()[e.parentId];c(f)}}c(d);return{"padding-left":(18+b*15)+"px"}};this.GetMenuItemCssClass=function(e){var d=a.currentTopic();var c=a.currentPage();var b={disabled:!a.IsItemEnabled(e),isCurrent:(c&&c.id===e.id)||(d&&d.id===e.id),"cmenu-group":e.type==="topic",selected:e.selected()};return b};this.GetItemStatusCssClass=function(b){if(!b){return}if(b.visited()&&!b.completed()){return"incomplete"}if(b.completed()){return"passed"}return"notstarted"};this.optionsMenu=null;this.ShowOptionsMenu=function(){a.Pause();a.optionsMenu.open()};this._OnOptionsMenuOpened=function(){$("#optionsClose").focus();a.EnableKeyboards([a._optionsMenuKeyboard])};this.CloseOptionsMenu=function(){a.optionsMenu.close()};this.isOptionsMenuVisible=function(){return a.config.buttons.reference()||a.config.buttons.language()||a.config.buttons.comments()};this._OnOptionsMenuClosed=function(){a.EnableKeyboards([a._defaultKeyboard,a._frameKeyboard]);a.Play()};this.isProgressMarkerVisible=ko.observable();this.fullItems=ko.pureComputed(function(){var b=a.currentOrg().itemsList();var d=a.currentOrg().items();var c=b.filter(function(e){if(e.type==="topic"||e.type==="mergedpages"){return false}return true});return c});this._GetProgressPageSegmentWidth=function(){var b=$("#progressContainer").width();var d=12;var e=a.currentOrg().items().filter(function(f){return f.type==="topic"});var c=(b-d*e.length)/(a.fullItems().length-1);return c};this.GetProgressSegmentWidth=function(b){var c=Math.floor(a._GetProgressPageSegmentWidth()*b.descendantPages().length);return c};this.GetProgressSegmentCompletedWidth=function(c){var b=c.descendantPages().filter(function(e){return e.completed()});var d=Math.floor(a._GetProgressPageSegmentWidth()*b.length);return d};this.GetProgressSegmentIncompletedWidth=function(c){var b=c.descendantPages().filter(function(e){return(!e.completed()&&e.visited())});var d=Math.floor(a._GetProgressPageSegmentWidth()*b.length);return d};this.GetProgressMarkerPosition=function(c){var d=0;if(!c){return}var e;function f(h){if(h){var i=a.currentOrg().itemsDict()[h];if(!i.parentId){e=i}else{f(i.parentId)}}}f(c.parentId);if(!e){a.isProgressMarkerVisible(false);return}else{a.isProgressMarkerVisible(true)}var b=$("#progressContainer .progressSegment[pele-id='"+e.id+"']");var g=this._GetProgressPageSegmentWidth();if(b.length){d=Math.floor(b.position().left-3+(a.DescendantIndexInParent(c,e)*g)+g)}return d+"px"};this.Resize=function(){if(a.isProgressActive()){a.isProgressActive(false);a.isProgressActive(true)}a.pageController()&&a.pageController().Resize();var b=$("#btnVolume").offset().left;$("#volumeControl").css("left",b)};this.GetContentHeight=function(){var b=$("#contentContainer");var c=a.audioTextEnabled()&&a.pageController()&&a.pageController().audioText()?b.height()-100:b.height();return c};this._InitUI=function(){var b=document.createElement("link");b.rel="stylesheet";b.href="ui/delta/delta.css";document.getElementsByTagName("head")[0].appendChild(b);a.InitElements();a.InitComponents();a.InitUIEventHandlers();a._uiInitialized=true};this.InitElements=function(){$("#search").on("click",function(b){a.ClearSelectedCourseItem();b.stopPropagation()})};this.InitComponents=function(){a.menu=new Menu({id:"menu",wrapper:"#outerContainer",type:"slide-left",maskId:"#c-mask",onOpen:a._OnMenuOpened,onClose:a._OnMenuClosed});a.optionsMenu=new Menu({id:"optionsMenu",wrapper:"#outerContainer",type:"slide-right",maskId:"#c-mask",onOpen:a._OnOptionsMenuOpened,onClose:a._OnOptionsMenuClosed});a.isProgressActive(a.config.buttons.progress());if(!a.isMobile()){$("#volumeSlider").slider({reversed:true,tooltip:"hide",min:0,max:1,step:0.01});$("#volumeSlider").slider()&&$("#volumeSlider").slider().on("change",function(b){var c=b.value;if(c.newValue!==0){a.isMuted(false)}a.nonMutedVolumeLevel(c.newValue);a.volumeLevel(c.newValue)})}};this.InitUIEventHandlers=function(){$(window).on("blur",function(b){$("#btnVolume, #volumeControl").removeClass("active");$(".dropdown.open .dropdown-toggle").dropdown("toggle")});$(document).on("mousedown",function(b){if(!$(b.target).closest("#btnVolume, #volumeControl").length){$("#btnVolume, #volumeControl").removeClass("active");$("#content-mask").hide()}});$(".navBtn").mouseup(function(){$(this).blur()});$("#btnVolume, #volumeControl").on("mouseenter",function(){$("#btnVolume, #volumeControl").addClass("show")});$("#btnVolume, #volumeControl").on("mouseleave",function(){$("#btnVolume, #volumeControl").removeClass("show")});$("#btnVolume, #volumeControl").on("mousedown",function(){$("#btnVolume, #volumeControl").addClass("active");$("#content-mask").show()});$("#optionsMenu .cmenu-item").on("click",function(){a.optionsMenu.close()})}}if(!ko.components.isRegistered("delta")){ko.components.register("delta",{viewModel:{createViewModel:function(b,a){var c=b.model;c._InitUI();return c}},template:{require:"text!ui/delta/delta.html"}})}CBTPlayer.RegisterUserInterface("delta",DeltaUIExt);